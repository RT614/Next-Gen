<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Next Gen Escape Room</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background-color: #6138F5; color: #eee; padding: 20px; }
        .container { max-width: 600px; margin: auto; }
        .question { margin-bottom: 20px; }
        .leaderboard { margin-top: 40px; border-top: 1px solid #444; padding-top: 20px; }
        input, button { padding: 10px; margin-top: 10px; width: 100%; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #444; padding: 8px; text-align: left; }
        label { display: block; margin: 5px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Learn in the OSS Laboratory</h1>
        <p>Answer all 10 trivia questions to reach the next level. Good luck!</p>

        <div id="game">
            <label for="playerName">Enter your name:</label>
            <input type="text" id="playerName" placeholder="Your name">
            <button onclick="startGame()">Start Game</button>
        </div>

        <div id="questionArea" style="display:none;"></div>
        <div id="leaderboard" class="leaderboard">
            <h2>Leaderboard</h2>
            <table>
                <thead>
                    <tr><th>Name</th><th>Correct</th><th>Time</th><th>Timestamp</th><th>GameTitle</th></tr>
                </thead>
                <tbody id="leaderboardBody"></tbody>
            </table>
            <button onclick="downloadExcel()">Download Leaderboard as Excel</button>
        </div>
    </div>

    <script>
        const questions = [
            { q: "What is the primary goal of Xfinity’s Next Gen pricing and packaging?", options: ["Increase customer bills", "Simplify the customer experience and offer more value", "Introduce more contracts", "Limit internet access"], a: "Simplify the customer experience and offer more value" },
            { q: "When did the Next Gen pricing and packaging launch?", options: ["January 1, 2025", "June 26, 2025", "March 15, 2025", "May 15, 2025"], a: "June 26, 2025" },
            { q: "Which of the following is not included in the Next Gen internet plans?", options: ["Unlimited data", "Xfinity WiFi Gateway", "Early termination fees", "No contracts"], a: "Early termination fees" },
            { q: "Who is eligible for Next Gen pricing and packaging?", options: ["Only new customers", "Only existing customers", "New customers and existing customers who repackage", "XM Customers"], a: "New customers and existing customers who repackage" },
            { q: "What must customers use to qualify for the $10 APPD discount?", options: ["Credit card", "Stored bank account", "PayPal", "Cash"], a: "Stored bank account" },
            { q: "Which speed tier is only available in FDX and Genesis markets?", options: ["300 Mbps", "500 Mbps", "1 Gig", "2 Gig"], a: "2 Gig" },
            { q: "What happens to legacy speed tiers like Connect and Fast for existing customers?", options: ["They are upgraded to Next Gen automatically", "They are discontinued for all customers", "They remain active for existing customers", "They are renamed under Next Gen"], a: "They remain active for existing customers" },
            { q: "What is required to qualify for Next Gen multi-product discounts (MPDs)?", options: ["Adding a Next Gen speed tier", "Signing a 5-year contract", "Using a credit card", "Purchasing legacy plans"], a: "Adding a Next Gen speed tier" },
            { q: "What special deal is available for new Xfinity Mobile customers under Next Gen?", options: ["Free phone", "Unlimited data for 6 months", "First line of Unlimited included for $0 for 12 months", "Free international calling"], a: "First line of Unlimited included for $0 for 12 months" },
            { q: "What is a key message Xfinity representatives should communicate about Next Gen??", options: ["It’s less options but faster", "It locks customers into long-term contracts", "It offers added value, flexibility, and a simplified experience", "It’s only available in select cities"], a: "It offers added value, flexibility, and a simplified experience" }
        ];

        let current = 0;
        let correct = 0;
        let startTime;

        function startGame() {
            const name = document.getElementById("playerName").value;
            if (!name) return alert("Please enter your name.");
            startTime = new Date();
            document.getElementById("game").style.display = "none";
            document.getElementById("questionArea").style.display = "block";
            showQuestion();
        }

        function showQuestion() {
            const q = questions[current];
            let optionsHtml = "";
            q.options.forEach((opt, index) => {
                optionsHtml += `<label><input type='radio' name='answer' value='${opt}'> ${String.fromCharCode(65 + index)}. ${opt}</label>`;
            });
            document.getElementById("questionArea").innerHTML = `
                <div class='question'>
                    <p><strong>Question ${current + 1}:</strong> ${q.q}</p>
                    ${optionsHtml}
                    <button onclick='submitAnswer()'>Submit</button>
                </div>
            `;
        }

function submitAnswer() {
  const selected = document.querySelector("input[name='answer']:checked");
  if (!selected) return alert("Select an answer");

  const correctAnswer = questions[current].a;
  const allOptions = document.querySelectorAll("input[name='answer']");

if (selected.value === correctAnswer) {
  correct++; // ✅ increment correct answers
}

  allOptions.forEach(option => {
    option.disabled = true; // prevent further changes
    if (option.value === correctAnswer) {
      option.parentElement.style.backgroundColor = "#2ecc71"; // green for correct
    } else if (option.checked) {
      option.parentElement.style.backgroundColor = "#e74c3c"; // red for wrong
    }
  });

  // Add a delay before moving to the next question
  setTimeout(() => {
    current++;
    if (current < questions.length) {
      showQuestion();
    } else {
      endGame();
    }
  }, 1500); // 1.5 seconds delay
}

        function endGame() {
            const endTime = new Date();
            const timeTaken = new Date(endTime - startTime).toISOString().substr(11, 8);
            const timestamp = endTime.toLocaleString();
            const name = document.getElementById("playerName").value;
             const gameTitle = document.querySelector("title").innerText;
            const entry = { name, correct, timeTaken, timestamp, gameTitle };
            let leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];
            leaderboard.push(entry);
            localStorage.setItem("leaderboard", JSON.stringify(leaderboard));
            displayLeaderboard();
        }

        function displayLeaderboard() {
            document.getElementById("questionArea").style.display = "none";
            document.getElementById("leaderboard").style.display = "block";
            const leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];
            const tbody = document.getElementById("leaderboardBody");
            tbody.innerHTML = "";
            leaderboard.forEach(entry => {
                tbody.innerHTML += `<tr><td>${entry.name}</td><td>${entry.correct}</td><td>${entry.timeTaken}</td><td>${entry.timestamp}</td><td>${entry.gameTitle || "Next Gen Escape Room"}</td></tr>`;
            });
        }

        function downloadExcel() {
            const leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];
            const worksheet = XLSX.utils.json_to_sheet(leaderboard);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Leaderboard");
            XLSX.writeFile(workbook, "escape_room_leaderboard.xlsx");
        }

        window.onload = displayLeaderboard;
    </script>
</body>
</html>



